From d4ccd11fc7f959fa35205768d5916991bde1f37e Mon Sep 17 00:00:00 2001
From: Andrea Marchesini <amarchesini@mozilla.com>
Date: Thu, 3 Mar 2016 18:30:16 +0100
Subject: [PATCH 16/18] Bug 1253215 - Initialize RequestSyncService only if its
 pref is enabled, r=ehsan

Signed-off-by: Raine Makelainen <raine.makelainen@jolla.com>
---
 dom/requestsync/RequestSyncService.jsm | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/dom/requestsync/RequestSyncService.jsm b/dom/requestsync/RequestSyncService.jsm
index 064912b..7fb61fe 100644
--- a/dom/requestsync/RequestSyncService.jsm
+++ b/dom/requestsync/RequestSyncService.jsm
@@ -76,6 +76,10 @@ this.RequestSyncService = {
   init: function() {
     debug("init");
 
+    if (!Services.prefs.getBoolPref("dom.requestSync.enabled")) {
+      return;
+    }
+
     this._messages.forEach((function(msgName) {
       ppmm.addMessageListener(msgName, this);
     }).bind(this));
-- 
2.7.4

